## 1. 产品定位 & 目标

**一句话定位**
一个“带 AI 的个人网页知识库 / 高级书签”，自动帮用户抓网页内容、打标签、写简介，并通过对话快速回答“我以前看过的那篇文章里说了啥”。

**核心目标**

1. 降低收藏成本：用户只管点“保存”，不用管理文件夹、标签。
2. 提升回忆效率：用自然语言或对话的方式，让用户快速找到之前收藏网页里的具体信息。
3. 让书签变成知识库：不仅能“找到链接”，还能“直接看到答案 / 摘要 / 关键点”。

---

## 2. 目标用户 & 使用场景

### 2.1 目标用户

* 大量阅读/收集网页内容的用户：

  * 程序员 / 产品 / 研究者 / 自媒体 / 学生等
* 有“收藏强迫症”，但事后很难再翻出有用信息的人
* 已经使用浏览器书签、Notion、Readwise 等，但感觉“查找成本高”的用户

### 2.2 核心使用场景

1. **浏览网页时，一键收藏**

   * 看到一篇文章不错，点击“保存到知识库”
   * 不想手动写标题、分类、标签。

2. **一段时间后，想起某个模糊记忆**

   * 例：“之前收藏过一篇讲 TypeScript utility types 的文章，怎么找回来？”
   * 在搜索框输入自然语言，或打开对话框问 AI。

3. **复习某个主题的知识**

   * 例：“我这些收藏里，关于 ‘前端性能优化’ 的都有哪些？帮我串一下重点。”
   * AI 汇总用户保存过的相关网页内容，做结构化回答。

4. **做具体查找**

   * 例：“我之前收藏的那篇 React18 concurrent mode 的文章，里面提到 useTransition 的典型用法是什么？”

---

## 3. 客户端形态 & 系统构成（高层）

不做死约束，只作为需求建议：

* **客户端**

  * 浏览器扩展（优先）：支持 Chrome / Edge，负责“当前页一键收藏”。
  * Web / 桌面客户端（选做）：浏览和对话的主界面，也可以手动粘贴链接保存。
  * 移动端：后续版本。

* **服务端**

  * 网页抓取服务：根据 URL 抓 HTML / 文章正文。
  * AI 处理服务：调用 LLM 做摘要、打标签、向量化。
  * 检索服务：全文检索 + 向量检索，支撑搜索和对话。

---

## 4. 功能需求（按模块拆）

### 4.1 收藏网页

**4.1.1 保存入口**

* 浏览器插件按钮：“保存当前页面”
* Web/App 里手动输入 URL：“+ 添加链接”
* 可选：支持从剪贴板自动识别链接

**4.1.2 用户可选填写字段**

* 标题（默认用网页 `<title>`，用户可手动改）
* 备注（可空）
* 收藏到的“空间”/“知识库”（如果后面支持多知识库的话）

**4.1.3 收藏后的系统行为**

* 后台异步：

  * 爬取该网页内容
  * 提取正文（正文抽取/去广告）
  * 存储原始 HTML/正文文本
  * 触发 AI 生成标签与摘要
  * 生成用于检索的索引/向量

* 前端提示：

  * 显示“已保存，正在分析”
  * 分析完成后更新该条目的标签 & 简介（可通过通知 / 列表刷新）

**4.1.4 异常 & 边界情况**

* 无法访问网页（404、需要登录、反爬）：

  * 给出失败标记 & 用户可手动粘贴正文或上传文本
* 重复收藏同一 URL：

  * 提示“已收藏”，可选择更新内容或新增一条版本

---

### 4.2 网页内容抓取 & 解析

**4.2.1 抓取内容类型**

* 普通 HTML 页面
* 文章/博客/文档页
* 简单支持：PDF（可选，V2）
* 不强制支持：需要复杂交互的 SPA，只取静态渲染到的文本

**4.2.2 解析规则**

* 提取：

  * 标题
  * 正文主要内容（使用正文抽取算法）
  * 作者、时间（如能解析）
* 清洗：

  * 去掉导航栏、评论、脚注广告等
  * 去除脚本、样式等无关内容

**4.2.3 元数据**

为每条“网页知识条目”记录：

* id
* url
* 标题
* 抓取时间
* 内容文本（正文）
* 语言（自动检测，如中/英）
* 字数/内容长度
* 来源域名（domain）
* 用户创建时间 / 更新时间

---

### 4.3 AI 自动标签 & 摘要

**4.3.1 标签需求**

* 每篇网页生成 **3～5 个标签**
* 标签特点：

  * 简短、可读（2～6 个字）
  * 尽量使用通用主题词。如：“React”、“前端性能”、“投资入门”、“AI 应用架构”等
* 标签维度：

  * 主题类（React、经济学、AI Agent）
  * 类型类（教程、长文、论文、新闻、工具页）
  * 领域类（前端、后端、投资、历史）

**4.3.2 摘要需求**

* 摘要长度：**150 字以内（中文）** 或相近长度的英文
* 要求：

  * 清晰说明这篇网页“主要讲什么”
  * 尽量避免抄原文一句话；更像“给未来的自己看的注解”
  * 可包含 2～3 个关键信息点

**4.3.3 用户可编辑**

* 用户可手动：

  * 编辑标签（新增、删除）
  * 编辑摘要
* 编辑后：

  * 保留用户修改结果（不再被自动覆盖）
  * 可以有“重新用 AI 生成”按钮

---

### 4.4 知识库浏览 & 搜索

**4.4.1 列表视图**

每条内容展示：

* 标题
* 来源域名 + 收藏时间
* 自动摘要
* 自动标签
* 操作：编辑 / 删除 / 打开原文

**4.4.2 搜索能力**

提供两种入口：

1. **关键词搜索栏**

   * 按标题、正文、标签进行全文搜索
   * 支持模糊匹配 & 拼音（可选）

2. **自然语言搜索**

   * 用户可以写一句话，例如：

     * “那篇我收藏的讲 useEffect 最佳实践的文章”
     * “最近收藏的关于美国大选的深度分析”
   * 系统将查询转为检索请求（语义向量检索）

**4.4.3 筛选 & 排序**

* 筛选条件：

  * 标签
  * 时间范围
  * 来源域名
  * 内容语言
* 排序：

  * 最近收藏
  * 与搜索相关度
  * 最近阅读（未来可加阅读历史）

---

### 4.5 AI 对话问答（RAG）

**4.5.1 入口形态**

* 独立页面或侧边抽屉形式的“聊天窗口”
* 类似 ChatGPT 界面，左侧是会话列表，右侧是对话内容（可后续）

**4.5.2 使用方式**

* 用户可以像平时和 LLM 聊天一样：

  * “我之前收藏的文章里，有哪些讲到了 TypeScript 的高级类型？帮我总结一下。”
  * “列出我收藏里所有提到 Web 性能指标 FID / LCP 的文章，并给出原文引用。”

**4.5.3 对话行为要求**

* 模型回答时需要：

  1. 根据用户问题，检索相关网页内容（向量检索 + 关键词检索）
  2. 将检索到的片段作为上下文，生成回答
  3. 在回答中展示引用来源：

     * 比如“来自：XXX（2024-05-01 收藏）”
* 支持：

  * 追问：“那篇文章里提到的第 3 个优化手段是啥？”
  * 上下文记忆：同一对话内可以保持当前问题的上下文

**4.5.4 用户控制范围**

* 可选：用户可指定范围，比如：

  * “只用最近一个月收藏的内容回答”
  * “只用标签为‘前端性能’的内容回答”

**4.5.5 回答失败/无匹配情况**

* 当检索不到相关内容：

  * 明确提示：“你的知识库中暂时没有相关内容，我可以用通用知识来解释这个话题吗？”
  * 用户可选择“仅用个人知识库回答”或“允许通用信息补充”（产品策略可配）

---

### 4.6 账号 & 多端同步

**4.6.1 账号体系**

* 通过邮箱 / 第三方登录（Google / GitHub 等）
* 同一账号在不同设备共享知识库

**4.6.2 同步要求**

* 收藏记录、标签、摘要、对话历史需云端存储
* 多端登录时，数据实时同步（或定期拉取）

---

### 4.7 设置与偏好

* 标签语言偏好：

  * 自动使用网页原文语言 / 强制中文标签
* 摘要长度偏好：

  * 标准 150 字，也可以允许用户设置范围如 80～200 字
* AI 策略：

  * “只用我的知识库回答” / “允许通用知识补充” 开关
* 默认检索范围：

  * 默认最近 6 个月 / 全部内容

---

## 5. 数据 & AI 层面的需求（高层）

不写实现，只写产品级的“能力要求”：

1. **索引能力**

   * 每篇文章至少生成：

     * 字符串索引：标题、正文、标签
     * 语义向量索引：全文内容或摘要
   * 支持基于向量的 Top-K 召回，并按相关度排序

2. **多语言支持**

   * 能区分中/英等语言
   * 检索时可进行跨语言语义检索（用中文搜英文文章）

3. **模型调用场景**

   * 生成标签与摘要
   * 将用户自然语言查询转成检索意图
   * 对话时基于检索结果生成回答

4. **成本控制**

   * 对长文可做分段 & 分块摘要，必要时仅对“正文抽取后”的部分做向量化
   * 后台批处理 / 队列式 AI 调用

---

## 6. 非功能需求

### 6.1 性能体验

* 收藏操作：

  * 即刻响应（本地标记为“已保存”）
  * 知识解析与 AI 处理可以几秒〜几十秒内完成，但不阻塞用户
* 检索响应时间：

  * 搜索 / 对话的首字节在 1～3 秒内出现（流式输出更佳）

### 6.2 隐私 & 安全

* 所有网页内容默认仅对当前用户可见
* 清晰告知：

  * 网页内容会被传给 LLM 服务进行分析
* 支持：

  * 删除单条记录
  * 一键清空知识库（软删除或硬删除策略）

### 6.3 稳定性

* 对 AI 调用失败要有重试 & 降级

  * 比如失败就只保留“原文 + 标题”，标签/摘要为空但仍可检索

